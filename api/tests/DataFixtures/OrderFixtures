<?php
// tests/DataFixtures/OrderFixtures.php
namespace App\Tests\DataFixtures;

use App\Entity\Order;
use App\Entity\Product;
use App\Entity\User;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Persistence\ObjectManager;

class OrderFixtures extends Fixture
{
    public function load(ObjectManager $manager): void
    {
        // Créer un utilisateur
        $user = new User();
        $user->setEmail('user@example.com');
        $user->setPassword('$2y$13$...');  // Mot de passe haché
        $manager->persist($user);

        // Créer des produits
        $product1 = new Product();
        $product1->setName('Produit 1');
        $product1->setPrice(10.99);
        $manager->persist($product1);

        $product2 = new Product();
        $product2->setName('Produit 2');
        $product2->setPrice(15.99);
        $manager->persist($product2);

        // Créer une commande
        $order = new Order();
        $order->setUser($user);
        $order->setStatus('pending');
        $order->setDeliveryAddress('123 Rue Test, 75000 Paris');
        $order->setDeliveryDate(new \DateTime('2023-12-20 14:30'));
        $order->addProduct($product1);
        $order->addProduct($product2);
        $manager->persist($order);

        $manager->flush();
    }
}